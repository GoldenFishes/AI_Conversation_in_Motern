# 界面基础说明

![默认界面示意图](./asset/默认界面示意图.jpg)

图注：默认界面示意图，其中元素`A`为控制边栏，元素`B1`为主要工作区，元素`B2`为次要工作区



## A 控制边栏-说明



![控制边栏位置](./asset/控制边栏元素排列.jpg)

图注：控制边栏元素排列示意图。控制边栏中的元素以图标形式呈现，纵向排列。



**简介：**


控制边栏位于界面左侧，其中元素纵向排列。



**元素含义**：

元素`A0`表示菜单，**包含所有功能选项**（一些功能已经默认添加至控制边栏中，如`A1-A4`。其他不在控制边栏中直接显示的功能依然可以在控制边栏-菜单中找到），需要预留元素`A0`拓展空间。

元素`A1`表示 `Task State` ，含义是任务状态；

元素`A2`表示 `Stage State` ，含义是阶段状态；

元素`A3`表示 `Agent State` ，含义是Agent状态；

元素`A4`表示 `Step State` ，含义是步骤状态；



**呈现方式：**

元素`A0-A4`均默认以图标（具体图标暂未确定）的形式呈现。

鼠标悬停在对应元素上时显示元素对应含义的文字说明，

例如：菜单、Task 任务状态、Stage 阶段状态、Agent 智能体状态、Step 步骤状态。



**功能：**

控制边栏的主要功能是为右侧主要工作区（`B1`）呈现不同层级的内容。

1.用户点击元素`A1-A4`时：右侧主要工作区（`B1`）则显示该元素对应层级状态的内容。

2.用户点击元素`A0`时：展开控制边栏-菜单总览的第一层级目录，点击在第一层级目录中某个元素时，展开对应的第二层级目录。示意图如下：

![控制边栏_菜单总览操作](./asset/控制边栏_菜单总览操作.jpg)

图注：控制边栏-菜单（`A0`）操作示意图。鼠标首先点击元素`A0`展开第一级目录`A0_1-A0_9`，随后点击元素`A0_4`，展开其对应的第二级目录并最终选择元素`A0_4_3`。


**特殊说明：**

控制边栏默认元素是`A0-A4`，是为了方便用户而预设的常用功能。然而**所有的功能都可以在元素`A0`控制边栏-菜单中找到**





## B1 主要工作区-说明



### 1. 显示任务状态（TODO）

当点击控制边栏-任务状态（元素`A1`）时，主要工作区`B1`展示MAS所有任务状态。



![Task状态展示](./asset/Task状态展示.jpg)

图注：Task状态展示。每个Task State以一个独立的元素容器`C`显示在主要工作区`B1`中



**简介：**

点击选择 控制边栏-任务状态（`A1`） 时 主要工作区（`B1`）呈现 Muti-Agent System 中全部任务状态信息。每个任务状态信息以一个单立的元素容器（`C`）呈现，默认以行列对齐排布。


**呈现方式：**

每一个任务状态的元素容器`C`所包含的具体内容如下：

![任务状态](./asset/任务状态.jpg)

图注：任务状态示意图。展示一个任务状态时，在元素容器`C`中所包含的内容。

接下来我们将详细说明，在展示任务状态时，元素容器`C`所包含的各个组件是什么。



**数据来源：**

任务状态的数据来源通过接口：

```python
GET /api/states?type=task
```

返回格式：

```python
{
    "StateID_1": { "task_id": "...", "task_name": "...", ... },
    "StateID_2": { ... },
    ...
}
```

返回字典，每个键值对代表一条任务状态。

任务状态的详细属性同样以字典的形式包含在内。



#### C1 任务名称

元素`C1`表示任务名称。个任务简介的名称，向人类使用者提供基本的信息区分。



**呈现方式：**

填充字符串

**数据来源：**

获取任务状态 `task_name (str)` 字段内容；

**交互功能：**

允许复制字符串内容



#### C2 执行状态

元素`C2`表示任务执行状态，包含（"init"、"running"、"finished"、"failed"）



**呈现方式：**

填充字符串，"init"、"running"、"finished"、"failed"

并显示对应颜色，init 灰色，running 黄色，finished 绿色，failed 红色

**数据来源：**

获取任务状态 `execution_state (str)` 字段内容；

**交互功能：**

鼠标悬停时展开详细信息，移走时取消详细信息的展开；

鼠标点击时展开详细信息，点击其他地方才关闭详细信息的展开。

------

元素`C2`展开的 `执行状态-详细信息`：
![任务状态_C2展开](./asset/任务状态_C2展开.jpg)

图注：任务状态中执行状态（`C2`）的详细展开



其中元素`C2_1`展示任务ID；元素`C2_2`展示任务完成总结，如果任务执行状态未处于完成状态，则一般元素`C2_2`不会有任何实质的内容。



**呈现方式：**

元素`C2_1`和`C2_2`均以字符串填充；

元素`C2_1`的背景颜色与元素`C2`保持一致

**数据来源：**

元素`C2_1`从任务状态 `task_id (str)` 字段获取；

元素`C2_2`从任务状态 `task_summary (str)` 字段获取；

**交互功能：**

元素`C2_1`和`C2_2`均允许复制



#### C3 任务意图

元素`C3`表示任务执行状态，较为详细的任务目标说明



**呈现方式：**

填充字符串

**数据来源：**

获取 `task_intention (str)` 字段内容；

**交互功能：**

允许复制字符串内容



#### C4 任务阶段（TODO：点击阶段跳转）

元素`C4`用于展示任务中所有阶段，元素`D`用于表示其中一个阶段



**呈现方式：**

元素`C4`中将该任务下的每个阶段都以一个方块（元素`D`）的形式呈现，方块中不显示文字，方块颜色随着阶段的`execution_state`字段变化：init 灰色，running 深绿色，finished 浅绿色，failed 红色

方块从左往右对应获取字段的列表的顺序（该任务下的第一个阶段在最左侧，最后一个阶段在最右侧）

**数据来源：**

获取 `stage_list (list[Dict[str,str]])` 字段内容；

字段值为一个记录了多个阶段Stage的列表，列表中的每个Stage以字典形式表示：

```python
{
    "stage_id": str,
    "stage_intention": str,
    "execution_state": str,
}
```

**交互功能：**

对于元素`D`：

鼠标悬停时展开详细信息，移走时取消详细信息的展开；

鼠标点击时展开详细信息，点击其他地方才关闭详细信息的展开。

------

元素`D`展开的 `任务阶段-详细信息`：
![任务状态_D展开](./asset/任务状态_D展开.jpg)

图注：任务状态中任务阶段（`D`）的详细展开。其中元素`D1`展示阶段ID；元素`D2`展示阶段意图。



**呈现方式：**

元素`D1`和`D2`均以字符串填充；

元素`D1`的背景颜色与元素`D`保持一致

**数据来源：**

元素`D1`从任务状态 `stage_list 字段中，对应阶段字点的`stage_id (str)`字段获取；

元素`D2`从任务状态 `stage_list` 字段中，对应阶段字点的`stage_intention (str)`字段获取；

**交互功能：**

元素`D1`和`D2`均允许复制





#### C5 任务群组（TODO：点击Agent跳转）

元素`C5`展示任务群组，包含参与这个任务的所有Agent，每个Agent以一个独立的元素方框`E`表示。
其中任务管理Agent比较特殊，需要突出描边标明，以元素方框`E_0`代表。



**呈现方式：**

元素`C5`中将该任务群组的每个Agent都以一个方块（元素`E`）的形式呈现。

方块中不显示文字，方块颜色随着Agent的状态变化：
idle 绿色，working 黄色，waiting 红色

其中元素`E_0`代表管理Agent用特殊描边标明

**数据来源：**

- 直接获取：

获取 `task_group (list[str])` 字段内容，为所有Agent的agent_id。

获取 `task_manager (str)` 字段内容，为管理Agent的agent_id。需要为对应的元素`E_0`进行特殊标明。

- 间接获取：

在获取了所有Agent的agent_id后，如何知晓Agent的状态以填充元素方块`E`和`E_0`的颜色呢？

目前后端并未直接提供根据`agent_id`查询Agent的`working_state`的接口，但是查询Agent状态的API包含了Agent的working_state信息：

```python
GET /api/states?type=agent
```

返回MAS中所有Agent的状态：

```
{
    "StateID_1": { "working_state": "...",  ... },
    "StateID_2": { "working_state": "...",  ...  },
    ...
}
```

**交互功能：**

/





#### C6 共享消息池（TODO：展开的阶段/Agent点击跳转）

元素`C6`展示共享消息池，由于共享消息池的内容非常多，所以默认只呈现最新的两条消息。



**呈现方式：**

只呈现最新的两条消息，以字符串的形式呈现：[角色] 内容

```python
[<role>] <content>
[<role>] <content>
```

**数据来源：**

从任务状态获取 `shared_message_pool (List[Dict])` 字段内容，列表中每一个字典都是一条消息：

```python
{
    "agent_id": str,
    "role": str,
    "stage_id": str,
    "content": str
}
```



**交互功能：**

鼠标点击时展开详细信息，点击其他地方才关闭详细信息的展开。

------

元素`C6`展开的 `共享消息池-详细信息`：

![任务状态_C6展开](./asset/任务状态_C6展开.jpg)

图注：任务状态中共享消息池（`C6`）的详细展开。其中元素`C6_1`表示对应阶段；元素`C6_2`表示Agent角色；元素`C6_3`展示消息内容



**呈现方式：**

元素`C6_1` **显示固定字符串”Stage“** ，其背景颜色与任务阶段`C4`中对应的任务阶段一致（反映该阶段状态）

元素`C6_2`显示Agent的`role`角色字符串，其背景颜色与任务群组`C5`中的对应Agent一致（反映该Agent状态）

元素`C6_3`显示该条共享消息的内容，字符串。

**数据来源：**

直接获取：

从任务状态 `shared_message_pool (List[Dict])` 字段中可以获取所有共享消息的列表，列表中每一个元素都是一个字典形式的共享消息，包含：

```python
{
    "agent_id": str,
    "role": str,
    "stage_id": str,
    "content": str
}
```

元素`C6_2`需要获取`role`字段，元素`C6_3`需要获取`content`字段

间接获取：

元素`C6_1`表示阶段，阶段ID可从`stage_id`字段获取；则该阶段状态等信息可查询。

元素`C6_2`表示Agent，AgentID可从`agent_id`字段获取；则该Agent状态等信息可查询。



**交互功能：**

元素`C6_3`允许复制




------

### 2. 显示阶段状态





